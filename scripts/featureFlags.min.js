/*! Angular Feature Flags v0.1.0 Â© 2015 Michael Taranto */
!function(){angular.module("feature-flags",[]),angular.module("feature-flags").directive("featureFlag",["featureFlags",function(e){return{transclude:"element",priority:599,terminal:!0,restrict:"A",$$tlb:!0,compile:function(a,t){var r="featureFlagHide"in t;return a[0].textContent=" featureFlag: "+t.featureFlag+" is "+(r?"on":"off")+" ",function(a,t,n,i,l){var u,f;a.$watch(function(){return e.isOn(n.featureFlag)},function(e){var n=r?!e:e;n?(f=a.$new(),l(f,function(e){u=e,t.after(u).remove()})):(f&&(f.$destroy(),f=null),u&&(u.after(t).remove(),u=null))})}}}}]),angular.module("feature-flags").directive("featureFlagOverrides",["featureFlags",function(e){return{restrict:"A",link:function(a){a.flags=e.get(),a.isOn=e.isOn,a.isOverridden=e.isOverridden,a.enable=e.enable,a.disable=e.disable,a.reset=e.reset,a.isOnByDefault=e.isOnByDefault},template:'<div class="feature-flags">    <h1>Feature Flags</h1>    <div class="feature-flags-flag" ng-repeat="flag in flags">        <div class="feature-flags-name">{{flag.name || flag.key}}</div>        <div class="feature-flags-switch" ng-click="enable(flag)" ng-class="{\'active\': isOverridden(flag.key) && isOn(flag.key)}">ON</div>        <div class="feature-flags-switch" ng-click="disable(flag)" ng-class="{\'active\': isOverridden(flag.key) && !isOn(flag.key)}">OFF</div>        <div class="feature-flags-switch" ng-click="reset(flag)" ng-class="{\'active\': !isOverridden(flag.key)}">DEFAULT ({{isOnByDefault(flag.key) ? \'ON\' : \'OFF\'}})</div>        <div class="feature-flags-desc">{{flag.description}}</div>    </div></div>',replace:!0}}]),angular.module("feature-flags").service("featureFlagOverrides",["$rootElement",function(e){var a=e.attr("ng-app"),t="featureFlags."+a+".",r=function(e){return t+e},n=function(e){return 0===e.indexOf(t)},i=function(e,a){localStorage.setItem(r(a),e)},l=function(e){return localStorage.getItem(r(e))},u=function(e){localStorage.removeItem(r(e))};return{isPresent:function(e){return null!==l(e)},get:l,set:function(e,a){angular.isObject(e)?angular.forEach(e,i):i(a,e)},remove:u,reset:function(){var e;for(e in localStorage)n(e)&&localStorage.removeItem(e)}}}]),angular.module("feature-flags").service("featureFlags",["$q","featureFlagOverrides",function(e,a){var t={},r=[],n=function(a){var t=e.defer();return t.resolve(a),t.promise},i=function(e){return a.isPresent(e)},l=function(e){return i(e)?"true"===a.get(e):t[e]},u=function(e){return t[e]},f=function(e){return e.forEach(function(e){t[e.key]=e.active,e.active=l(e.key)}),angular.copy(e,r),r},s=function(e){return e.then(function(e){return f(e.data||e)})},c=function(){return r},g=function(e){return angular.isArray(e)?n(f(e)):s(e)},o=function(e){e.active=!0,a.set(e.key,!0)},v=function(e){e.active=!1,a.set(e.key,!1)},d=function(e){e.active=t[e.key],a.remove(e.key)};return{set:g,get:c,enable:o,disable:v,reset:d,isOn:l,isOnByDefault:u,isOverridden:i}}])}();